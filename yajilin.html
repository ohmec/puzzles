<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./puzzles.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:Bold,400|Hina+Mincho"/>
    <script type="application/javascript" src="./fastclick.js"></script>
    <script type="text/javascript" src="./render.js"></script>
    <script type="text/javascript" src="./yjpuzzles.js"></script>
    <script type="text/javascript" src="./yajilin.js"></script>
    <script src="./jquery.js"></script>
    <title>Yajilin Player</title>
  </head>
  <body>
    <div id="banner">
      <a href="index.html">Ohmec Puzzles</a><br/>
      Player for Yajilin <span id="jpfont">&#x30E4;&#x30B8;&#x30EA;&#x30F3;</span>
    </div>
    <div id="tabContainer">
      <ul id="tabs">
        <li class="active"><a href="#tab1">Game Play   </a></li>
        <li>               <a href="#tab2">Rules       </a></li>
        <li>               <a href="#tab3">Puzzles     </a></li>
        <li>               <a href="#tab4">About       </a></li>
      </ul>
    </div>
    <div id="tabsContent">
      <div id="tab1" class="tab_content" style="display: block;">
        <p>
          In the game Yajilin, the user sets some cells black, and
          creates one continuous line through the remaining white
          cells to satisfy the requirements of pre-set number
          cells (see Rules tab). To set the colors and draw the
          lines, you can use the mouse or keyboard keys:
          <ul>
            <li>
              Press the <b>right mouse button</b> to turn a cell
              black, or <b>middle mouse</b> to return to white.
            </li>
            <li>
              Alternately, you can use the <b>arrow keys</b> to move
              around the board, and press the <b>space bar</b> to
              toggle between the states, the <b>'1'</b> key to turn
              black, or the <b>'0'</b> key to turn white.  You can
              not alter the state of a square with a number and arrow value.
            </li>
            <li>
              To draw a path, <b>left click</b> on the center of a
              white cell to begin. From there, <b>drag</b> the mouse
              in the direction to create the path. The path will draw
              as the dragging continues.
            </li>
            <li>
              Alternately, once on the board, you can press the
              <b>shift key</b> and hold while moving around the board with
              the <b>arrow keys</b>.
            </li>
            <li>
              In addition, you can enter a key to indicate the type of
              path desired for that cell (and into its neighbors). These
              keys are as follows, and will extend the line into the
              center of the adjoining cells:
              <ul>
                <li>
                  <b>'-' key</b> to draw a full horizontal line
                  through the cell
                </li>
                <li>
                  <b>'|'</b> or <b>'I'</b> key to draw a full
                  vertical line through the cell
                </li>
                <li>
                  <b>'L','F','7'</b>, or <b>'7'</b> key to draw a
                  correspondingly shaped turn in the cell (i.e.
                  a left turn starting from the N, E, S, or
                  W direction).
                </li>
              </ul>
            </li>
            <li>
              Once created, a path can be removed by pressing the
              <b>backspace</b> key within a white cell. This deletes
              it just for this cell, but deletes the "arms" into the
              adjoining cells.
            </li>
            <li>
              You can press the <b>'.'</b> key to temporarily insert
              a dot in a cell as a visual reminder that it will eventually
              need a path. A <b>backspace</b> clears the dot.
            </li>
          </ul>
        </p>
        <p>
          In <b>Assist Mode</b> (0), the default, only the existance of errors
          or incomplete numbers is indicated.  In Assist Mode (1), the
          number of errors and incomplete numbers is indicated, see game rules.
          In Assist Mode (2), errors and completed rules are highlighted
          with digit colors.  In some cases the solve difficulty will
          greatly decrease in Assist Mode (2), so select depending upon
          the level of challenge desired. The game border will turn
          green if the grid is completed without error.  You can click
          the "undo" button on the bottom of the page to undo previous moves.
        </p>
        <p>
          Below, enter <b>puzzle code (0-<span id='puzzlecount1'>0</span>)</b>
          for one of a list of pre-defined puzzles, or a puzzle descriptor
          (see "Puzzles" tab). <b>Puzzle 0</b> shows an example of a completed
          puzzle. The following puzzle codes have <b>demos</b>, which will walk
          you through a solve to help you on the path to mastery:
          <span id='demolist1'>[]</span>).
        </p>
      </div>
      <div id="tab2" class="tab_content" style="display: none;">
        <a href="https://www.nikoli.co.jp/en/puzzles/yajilin" target="_blank">Yajilin</a>
        (<span id="jpfont">&#x30E4;&#x30B8;&#x30EA;&#x30F3;</span> or roughly
        "Arrow Link"), is a classic Japanese logic puzzle published by 
        <a href="https://www.nikoli.co.jp/en" target="_blank">Nikoli</a>.
        In Yajilin, the board begins with a collection of numbers and
        arrows within gray squares. These numbers and arrows indicate
        the number of black squares to be placed in the direction given.
        All numbers must be satisfied in order to complete the puzzle.
        In addition, a single continuous path must pass through all
        white squares.  The rules below relate to those numbers and
        how to complete the puzzle.
        <ol>
          <li>
            A digit with an arrow indicates the number of black cells on
            the board to the direction of the arrow. I.e. a '3&uarr;'
            cell means there must be three black cells above the 3 digit
            before the edge of the board.
          </li>
          <li>
            Digit cells are gray, and indicate that they do not need
            to be crossed with the path.
          </li>
          <li>
            Black squares may not touch horizontally or vertically, but
            may touch diagonally. It is OK for a black cell to touch
            a gray digit cell.
          </li>
          <li>
            A single continuous path must be drawn that goes through
            all white squares. The path must connect back with itself
            but can't cross itself or enter the same square twice.
          </li>
          <li>
            There will be some cells that are not under the rules of
            given directional digits. Those cells may end up black or
            white but must not violate the above rules.
          </li>
        </ol>
      </div>
      <div id="tab3" class="tab_content" style="display: none;">
        <p>
          Puzzles can be invoked by either a numerical entry from
          <b>0-<span id='puzzlecount2'>0</span></b>, or through a character
          description of the puzzle itself, entered into the Display
          form on the 'Game Play' tab. The numbered puzzles are
          hand-crafted of varying difficulty, roughly easy to hard.
          <b>Puzzle 0</b> shows a completed correct puzzle.
        </p>
        <p>
          To describe a puzzle, the character string must be of the
          form: "WxH:&lt;digit-arrow-descriptor&gt;", where W is a
          number indicating the width of the grid, and H the height.
          The digit descriptor is a list of the pre-defined
          digit contents plus an arrow direction, from left to right,
          then top to bottom. The arrow directions are indicated with
          ^ for up, v for down, &lt; for left, or &gt; for right.
          Blank cells are represented with a '-' character. To assist
          in the definition of a sparse board, a combination of <i>b</i>
          consecutive blanks can be represented with a lowercase letter
          from 'a' to 'z', corresponding to 1 to 26 consecutive blanks.
          Digit values greater than '9' should be represented with
          capital letters 'A' to 'Z' representing 10 to 35.  A dot '.'
          can be used as a visual separator, for example between rows.
          An example descriptor is as follows for entry 1:
          '<span id="descr1">descr</span>'.
        </p>
        <p>
          For Yajilin there are <span id='democount'>1</span> demo
          puzzles that can be helpful to walk through solving methods.
          They are puzzle codes <span id='demolist2'>[]</span>.
          Enter them in the Game Play tab with the code number and there
          will be added a demo panel to help with the solve.
        </p>
      </div>
      <div id="tab4" class="tab_content" style="display: none;">
        This playground was written using javascript and is available open
        source. All code is checked into the github repo at
        <a href="https://github.com/ohmec/puzzles">ohmec/puzzles</a>.
        Feel free to file bugs there!
      </div>
    </div>
    <div id="puzzleEntry">
      <center>
      <input type="text"                          id="userPuzzle"    size="40" />
      <input type="button" value="Display Puzzle" id="displayButton" class="button small" />
      </center>
    </div>
    <br />
    <div id="puzzleInterface">
      <div id="canvasDiv" style="border-color: black;">
        <canvas id="puzzleCanvas" class="fastclick" height="270" width="270" style="border-color: black;"></canvas>
      </div>    
      <br />
      <script type="text/javascript">
        let canvas = document.querySelector(".fastclick");
        new FastClick(canvas);
      </script>
      <br />
      <div id="buttonsDiv">
        <input class="button small" type="button" value="Undo"  id="undoButton"  />
        <input class="button small" type="button" value="Reset" id="resetButton" />
        <input class="button small" type="button" value="Current Assist Mode (0)" id="assistButton" />
        <input class="button small" type="button" value="Clear Ribbons" id="clearButton" style="display: none" />
        <p><span id='puzzledescr'></span></p>
        <p><span id='errortext'></span></p>
      </div>
    </div>
    <div id="demotab" style="display: none;">
      <input class="button small" type="button" value="prev" id="prevDemoButton"  />
      <input class="button small" type="button" value="next" id="nextDemoButton" />
      <p id='demop'><span id='demotext'></span></p>
    </div>
    <div id="ribbonbar">
      &nbsp;
    </div>
    <!-- some space to avoid the canvas from shrinking on demo mode -->
    <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
    <script type="text/javascript">
      $(document).ready(function(){ puzzleInit(); });
    </script>
  </body>
</html>

