<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./puzzles.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:Bold,400|Hina+Mincho"/>
    <script type="application/javascript" src="./fastclick.js"></script>
    <script type="text/javascript" src="./render.js"></script>
    <script type="text/javascript" src="./chocobanana.js"></script>
    <script type="text/javascript" src="./cbpuzzles.js"></script>
    <script src="./jquery.js"></script>
    <title>Choco Banana Player</title>
  </head>
  <body>
    <div id="banner">
      <a href="index.html">Ohmec Puzzles</a><br/>
      Player for Choco Banana <span id="jpfont">&#x30C1;&#x30E8;&#x30B3;&#x30D0;&#x30CA;&#x30CA;</a>
    </div>
    <div id="tabContainer">
      <ul id="tabs">
        <li class="active"><a href="#tab1">Game Play   </a></li>
        <li>               <a href="#tab2">Rules       </a></li>
        <li>               <a href="#tab3">Puzzles     </a></li>
        <li>               <a href="#tab4">About       </a></li>
      </ul>
    </div>
    <div id="tabsContent">
      <div id="tab1" class="tab_content" style="display: block;">
        <p>
          In Choco Banana, the goal is to convert all cells from
          the indeterminate gray state to black or white to create
          "rooms" of appropriate sizes (see Rules tab). To play,
          you can use the mouse to click or arrow and button keys
          to change colors:
          <ul>
            <li>
              A <b>left-click</b> on a cell turns it black.
            </li>
            <li>
              A <b>right-click</b> on a cell turns it white.
            </li>
            <li>
              A <b>middle-click</b> on a cell turns returns it to
              indeterminate gray.
            </li>
            <li>
              Once the mouse is pressed down, you can <b>drag the mouse</b>
              to set multiple squares in one sequence.
            </li>
            <li>
              Alternately, once on the board, you can use the
              <b>arrow keys</b> to move around the board, and press
              the <b>space bar</b> to toggle between the states, or
            </li>
            <li>
              press the <b>'1' key</b> to turn black, or
            </li>
            <li>
              press the <b>'0' key </b> to turn white, or
            </li>
            <li>
              press the <b>backspace key</b> to set back to indeterminate.
            </li>
          </li>
        </ul>
        </p>
        <p>
          In <b>Assist Mode</b> (0), the default, only the existance of errors
          or incomplete rooms is indicated.  In Assist Mode (1), the
          number of errors and incomplete rooms is indicated, see game rules.
          In Assist Mode (2), errors and completed rules are highlighted
          with digit colors.  In some cases the solve difficulty will
          greatly decrease in Assist Mode (2), so select depending upon
          the level of challenge desired. The canvas border will turn
          green if the grid is completed without error.  You can press
          the "undo" button on the bottom of the page to undo previous moves.
        </p>
        <p>
          Below, enter <b>puzzle code (0-<span id='puzzlecount1'>0</span>)</b>
          for one of a list of pre-defined puzzles, or a puzzle descriptor
          (see "Puzzles" tab). <b>Puzzle code 0</b> shows an example
          completed puzzle that can be helpful. The following puzzle codes
          have <b>demos</b>, which will walk you through a solve to help you
          on the path to mastery: <span id='demolist1'>[]</span>).
        </p>
      </div>
      <div id="tab2" class="tab_content" style="display: none;">
        <a href="https://www.nikoli.co.jp/en/puzzles/choco-banana" target="_blank">Choco Banana</a>
        (<span id="jpfont">&#x30C1;&#x30E8;&#x30B3;&#x30D0;&#x30CA;&#x30CA;</span>)
        is one of the newer Japanese logic puzzle published by
        <a href="https://www.nikoli.co.jp/en" target="_blank">Nikoli</a>.
        In Choco Banana, the puzzle board is initiated with some numbers
        that must be separated into collections of squares, or rooms, that
        contain the number of squares of that number. Sometimes rooms
        must be created without knowing in advance how many squares are
        contained. The following rules relate to these numbers and the
        size and shape of the rooms that must be created.
        <ol>
          <li>
            A number indicates the number of cells of the area containing
            this cell.
          </li>
          <li>
            Black cells must form a rectangle when linked with their neighbors.
            I.e. a collection of contiguous black cells could be of
            combined size 2x3, or 1x4, or 1x1, etc. If it contains a
            number it must be that combined size. For example a black
            room with the number three could be a 1x3 or 3x1 collection
            of black squares.
          </li>
          <li>
            White cells must <b>not</b> form a rectangle when linked with
            their neighbors. For example a white room with the number
            three could only be an L-shape collection of three white
            cells, though they could be in any orientation.
          </li>
          <li>
            Rooms, or collections of cells, do not need to contain a
            number.
          </li>
        </ol>
        Below select <b>puzzle 0</b> to see a completed sample grid.
        See the Game Play or Puzzles tab for how to invoke a demo.
      </div>
      <div id="tab3" class="tab_content" style="display: none;">
        <p>
          Puzzles can be invoked by either a numerical entry from
          <b>0-<span id='puzzlecount2'>0</span></b>, or through a character
          description of the puzzle itself, entered into the Display
          form on the 'Game Play' tab. The numbered puzzles are
          hand-crafted of varying difficulty, roughly easy to hard.
          Puzzle 0 shows a completed correct puzzle.
        </p>
        <p>
          To describe a puzzle, the character string must be of the
          form: "WxH:&lt;digit-descriptor&gt;", where W is a number
          indicating the width of the grid, and H the height.
          The digit descriptor is a list of the pre-defined
          digit contents, from left to right, then top to bottom.
          Blank cells are represented with a '-' character. To assist
          in the definition of a sparse board, a combination of <i>b</i>
          consecutive blanks can be represented with a lowercase letter
          from 'a' to 'z', corresponding to 1 to 26 consecutive blanks.
          Digit values greater than '9' should be represented with
          capital letters 'A' to 'Z' representing 10 to 35.  A dot '.'
          can be used as a visual separator, for example between rows.
          An example descriptor is as follows for entry 1:
          '<span id="descr1">descr</span>'.
        </p>
        <p>
          For Choco Banana there are <span id='democount'>1</span> demo
          puzzles that can be helpful to walk through solving methods.
          They are puzzle codes <span id='demolist2'>[]</span>.
          Enter them in the Game Play tab with the code number and there
          will be added a demo panel to help with the solve.
        </p>
      </div>
      <div id="tab4" class="tab_content" style="display: none;">
        This playground was written using javascript and is available open
        source. All code is checked into the github repo at
        <a href="https://github.com/ohmec/puzzles">ohmec/puzzles</a>.
        Feel free to file bugs there!
      </div>
    </div>
    <div id="puzzleEntry">
      <center>
      <input type="text"                          id="userPuzzle"    size="40" />
      <input type="button" value="Display Puzzle" id="displayButton" class="button small" />
      </center>
    </div>
    <br />
    <div id="puzzleInterface">
      <div id="canvasDiv" style="border-color: black;">
        <canvas id="puzzleCanvas" class="fastclick" height="270" width="270" style="border-color: black;"></canvas>
      </div>    
      <br />
      <script type="text/javascript">
        let canvas = document.querySelector(".fastclick");
        new FastClick(canvas);
      </script>
      <br />
      <div id="buttonsDiv">
        <input class="button small" type="button" value="Undo" id="undoButton"  />
        <input class="button small" type="button" value="Reset" id="resetButton" />
        <input class="button small" type="button" value="Current Assist Mode (0)" id="assistButton" />
        <input class="button small" type="button" value="Clear Ribbons" id="clearButton" style="display: none" />
        <p><span id='puzzledescr'></span></p>
        <p><span id='errortext'></span></p>
      </div>
    </div>
    <div id="demotab" style="display: none;">
      <input class="button small" type="button" value="prev" id="prevDemoButton"  />
      <input class="button small" type="button" value="next" id="nextDemoButton" />
      <p id='demop'><span id='demotext'></span></p>
    </div>
    <div id="ribbonbar">
      &nbsp;
    </div>
    <!-- some space to avoid the canvas from shrinking on demo mode -->
    <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
    <script type="text/javascript">
      $(document).ready(function(){ puzzleInit(); });
    </script>
  </body>
</html>

