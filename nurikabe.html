<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./puzzles.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:Bold,400|Hina+Mincho"/>
    <script type="text/javascript" src="./render.js"></script>
    <script type="text/javascript" src="./nkpuzzles.js"></script>
    <script type="text/javascript" src="./nurikabe.js"></script>
    <title>Nurikabe Player</title>
  </head>
  <body>
    <div id="banner">
      <a href="index.html">Ohmec Puzzles</a><br/>
      Player for Nurikabe <span id="jpfont">&#x306C;&#x308A;&#x30B3;&#x304B;&#x3079;</span>
    </div>
    <div id="tabContainer">
      <ul id="tabs">
        <li class="active"><a href="#tab1">Game Play   </a></li>
        <li>               <a href="#tab2">Rules       </a></li>
        <li>               <a href="#tab3">Puzzles     </a></li>
        <li>               <a href="#tab4">About       </a></li>
      </ul>
    </div>
    <div id="tabsContent">
      <div id="tab1" class="tab_content" style="display: block;">
        <p>
          In the game Nurikabe, the goal is to turn some of the board
          cells black or white in order to create rooms of white cells
          equivalent in size to numbers on the board (see Rules tab).
          You can use the mouse or keys to set cells:
          <ul>
            <li>
              With the mouse you can <b>left-click</b> on a cell to
              turn it black, a <b>right-click</b> turns a cell white,
              or a <b>middle-click</b> returns a cell to the gray
              indeterminate set.
            </li>
            <li>
              Once the mouse is pressed down, you can <b>drag</b> the mouse
              to set multiple squares in one sequence.
            </li>
            <li>
              You can use the arrow keys to move around the board, and
              press the <b>space bar</b> to toggle between the states.
            </li>
            <li>
              Alternately you can press the <b>'1'</b> key to turn black,
              the <b>'0'</b> key to turn white, or <b>backspace</b> to
              set back to indeterminate.
            </li>
            <li>
              You can not alter the state of a white square with a digit.
            </li>
          </ul>
        </p>
        <p>
          In <b>Assist Mode</b> (0), the default, only the existance of errors
          or incomplete numbers is indicated.  In Assist Mode (1), the
          number of errors and incomplete numbers is indicated, see game rules.
          In Assist Mode (2), errors and completed rules are highlighted
          with digit colors.  In some cases the solve difficulty will
          greatly decrease in Assist Mode (2), so select depending upon
          the level of challenge desired. The game border will turn
          green if the grid is completed without error.  You can click
          the "undo" button on the bottom of the page to undo previous moves.
        </p>
        <p>
          Below, enter <b>puzzle code (0-<span id='puzzlecount1'>0</span>)</b>
          for one of a list of pre-defined puzzles, or a puzzle descriptor
          (see "Puzzles" tab). <b>Puzzle code 0</b> shows an example completed
          puzzle that can be helpful. The following puzzle codes have <b>demos</b>,
          which will walk you through a solve to help you on the path to
          mastery: <span id='demolist1'>[]</span>).
        </p>
      </div>
      <div id="tab2" class="tab_content" style="display: none;">
        <a href="https://www.nikoli.co.jp/en/puzzles/nurikabe" target="_blank">Nurikabe</a>
        (<span id="jpfont">&#x306C;&#x308A;&#x30B3;&#x304B;&#x3079;</span>
        or Invisible Wall), is a classic Japanese logic puzzle published by 
        <a href="https://www.nikoli.co.jp/en" target="_blank">Nikoli</a>.
        In Nurikabe, the board begins with a collection of numbers within
        white squares. These numbers indicate a "room size" that must be
        satisfied in order to complete the puzzle. The room must consist
        of combined white squares, connected horizontally or vertically.
        The rules below relate to those numbers and how to complete the puzzle.
        <ol>
          <li>
            A number indicates the number of white cells in the area containing
            the value. All rooms with numbers must be white, and the
            rooms must be bounded horizontally and vertically by black
            squares.
          </li>
          <li>
            All squares must be set to black or white, and white squares
            must be part of a room with a value.
          </li>
          <li>
            Each room with a number can only contain one number.
          </li>
          <li>
            The black cells must all form one contiguous "river" of black
            cells, connected to each other in the vertical or horizontal
            direction. A river is not considered connected if it only flows
            through diagonally adjacent black cells.
          </li>
          <li>
            No "pools" of black cells of size 2x2 or larger are allowd.
          </li>
        </ol>
      </div>
      <div id="tab3" class="tab_content" style="display: none;">
        <p>
          Puzzles can be invoked by either a numerical entry from
          <b>0-<span id='puzzlecount2'>0</span></b>, or through a character
          description of the puzzle itself, entered into the Display
          form on the 'Game Play' tab. The numbered puzzles are
          hand-crafted of varying difficulty, roughly easy to hard.
          <b>Puzzle 0</b> shows a completed correct puzzle.
        </p>
        <p>
          To describe a puzzle, the character string must be of the
          form: "WxH:&lt;digit-descriptor&gt;", where W is a number
          indicating the width of the grid, and H the height.
          The digit descriptor is a list of the pre-defined
          digit contents, from left to right, then top to bottom.
          Blank cells are represented with a '-' character. To assist
          in the definition of a sparse board, a combination of <i>b</i>
          consecutive blanks can be represented with a lowercase letter
          from 'a' to 'z', corresponding to 1 to 26 consecutive blanks.
          Digit values greater than '9' should be represented with
          capital letters 'A' to 'Z' representing 10 to 35.  A dot '.'
          can be used as a visual separator, for example between rows.
          An example descriptor is as follows for entry 1:
          '<span id="descr1">descr</span>'.
        </p>
        <p>
          For Nurikabe there are <span id='democount'>1</span> demo
          puzzles that can be helpful to walk through solving methods.
          They are puzzle codes <span id='demolist2'>[]</span>.
          Enter them in the Game Play tab with the code number and there
          will be added a demo panel to help with the solve.
        </p>
      </div>
      <div id="tab4" class="tab_content" style="display: none;">
        This playground was written using javascript and is available open
        source. All code is checked into the github repo at
        <a href="https://github.com/ohmec/puzzles">ohmec/puzzles</a>.
        Feel free to file bugs there!
      </div>
    </div>
    <div id="puzzleEntry">
      <center>
      <input type="text"                          id="userPuzzle"    size="40" />
      <input type="button" value="Display Puzzle" id="displayButton" class="button small" />
      </center>
    </div>
    <br />
    <div id="puzzleInterface">
      <div id="canvasDiv" style="border-color: black;">
        <canvas id="puzzleCanvas" class="pcanvas" height="270" width="270" style="border-color: black;"></canvas>
      </div>    
      <br />
      <script type="text/javascript">
        let canvas = document.querySelector(".pcanvas");
      </script>
      <br />
      <div id="buttonsDiv">
        <input class="button small" type="button" value="Undo"  id="undoButton"  />
        <input class="button small" type="button" value="Reset" id="resetButton" />
        <input class="button small" type="button" value="Current Assist Mode (0)" id="assistButton" />
        <input class="button small" type="button" value="Clear Ribbons" id="clearButton" style="display: none" />
        <p><span id='puzzledescr'></span></p>
        <p><span id='errortext'></span></p>
      </div>
    </div>
    <div id="demotab" style="display: none;">
      <input class="button small" type="button" value="prev" id="prevDemoButton"  />
      <input class="button small" type="button" value="next" id="nextDemoButton" />
      <p id='demop'><span id='demotext'></span></p>
    </div>
    <div id="ribbonbar">
      &nbsp;
    </div>
    <!-- some space to avoid the canvas from shrinking on demo mode -->
    <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
    <script type="text/javascript">
      puzzleInit();
    </script>
  </body>
</html>

